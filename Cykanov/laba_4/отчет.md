# Лабораторная работа: Интеграция GitLab CI/CD с репозиторием Nexus и автоматизация сборки Python-приложения

## Выполнили

Сныткин Илья, группа ИС-23
Поляков Никита, группа ИС-23

## Цель работы

1. Настроить взаимодействие между **GitLab** и **Nexus**.
2. Реализовать полный DevOps-цикл для простого Python-приложения `text_tool.py`, включающий:
   - запуск автоматических тестов в GitLab CI,
   - сборку Docker-образа,
   - публикацию образа в Docker-репозиторий, размещённый в Nexus.
3. Обеспечить автоматизацию развёртывания с использованием **Docker Compose** и конфигурации **GitLab CI/CD**.

## Описание приложения

Приложение представляет собой утилиту `text_tool.py`, реализующую базовые операции с текстовыми данными:

- Подсчёт общего количества слов во входной строке.
- Определение и возврат самого длинного слова из входной строки.

Приложение написано на языке Python и предназначено для последующего контейнеризации и развёртывания в среде, управляемой через GitLab CI/CD и Nexus Repository Manager.

## Задача 1. Подготовка окружения (GitLab + Nexus)

## 1. Конфигурационный файл `docker-compose.yaml`

Для развёртывания локальной инфраструктуры DevOps были настроены два сервиса: **GitLab** и **Nexus Repository Manager 3**.
Ниже приведён скриншот содержимого файла `docker-compose.yaml` сделанного с учетом на будущее, после благодаря команде `docker compose up -d` был запущен контейнер в фоновом режиме:

скрин сюда (DOCKERA-COMPOSE.YML ДО ИЗМЕНЕНИЙ!! САМЫЙ СУКА ПЕРВЫЙ))

### 2. Настройка локального разрешения имён (файл `hosts`)

Для корректного обращения к сервисам по доменным именам `gitlab.local` и `nexus.local` потребовалось внести изменения в файл `hosts` на уровне хост-системы. Учитывая, что работа велась в гибридной среде (**Windows 11** с установленным **WSL2 + Debian GNU/Linux 12**), изменения были внесены в обе системы.

#### 1. Настройка в Windows

Файл `hosts` в Windows расположен по пути: `C:\Windows\System32\drivers\etc\hosts`

Для редактирования файла:

- Открыли Блокнот **от имени администратора**,
- Открыли указанный файл через меню «Файл → Открыть»,
- Добавили следующие строки:

```text
127.0.0.1 gitlab.local
127.0.0.1 nexus.local
```

После этого браузер на Windows (например, Chrome или Edge) стал корректно разрешать имена **`gitlab.local:8081` и `nexus.local:8082`.

#### 2. WSL (Debian)

В файле находящемся по пути: `sudo nano /etc/hosts` были добавлены те же строки что и на Windows

```bash
127.0.0.1 gitlab.local
127.0.0.1 nexus.local
```

После этого оба сервиса стали доступны по указанным доменным именам как из браузера Windows, так и из терминала WSL.

### Запуск веб-версий сервисов GITLAB и NEXUS

После команды `docker compose up -d` после этого из общего реестра скачиваются два образа GITLAB и NEXUS и в фоновом режиме запускаются, спустя 10 - 15 минут запустился `GITLAB` при переходе на веб версию сайта спрашивается `login/password` так как изначально мы не знаем нашего пароля то пришлось взять его из самого образа GITLAB с помощью команды `docker exec -it Gitlab bash `

![скрин паролей](screen\Пароли.jpg)

После этого был осуществлен вход в GITLAB и NEXUS

Главное меню `GITLAB`

![Главное меню](screen\gitlabmain.png)

Главное меню `NEXUS`

![NEXUSMAIN](screen\nexusmain.png)

### Вывод по Задаче 1

В ходе выполнения задачи было успешно развёрнуто локальное DevOps-окружение, включающее GitLab и Nexus Repository Manager, с помощью Docker Compose. Оба сервиса запущены в фоновом режиме и доступны по заданным URL-адресам. Настроено локальное разрешение имён `gitlab.local` и `nexus.local` как в Windows, так и в WSL, что обеспечило корректную работу веб-интерфейсов и взаимодействие между компонентами. Подготовленная инфраструктура готова к дальнейшей интеграции через GitLab CI/CD и публикации Docker-образов в Nexus.

## Задача 2. Создание Python-приложения

## 1. Структура репозитория

Репозиторий имеет следующую структуру файлов:

![Структура](screen\strykt.png)

Все файлы находятся в корне проекта, что упрощает запуск как вручную, так и в CI/CD-среде.

### 2. Содержимое файла `text_tool.py`

Файл реализует две функции для обработки текстовых данных:

    ![codetext](screen\text-tool.png)

* `count_words(text)` разбивает строку по пробелам и возвращает длину полученного списка.
* `longest_word(text)` находит слово с максимальной длиной с помощью встроенной функции `max()` и ключа `key=len`.
  Если входная строка пуста — возвращается `None`.

### 3. Содержимое файла `test_text_toop.py`

Для проверки корректности работы функций были написаны модульные тесты с использованием фреймворка **pytest** **:**

![texttoop](screen\text-work.py.png)

### 4. Содержимое файла `requirements.txt`

Файл содержит единственный зависимый пакет, необходимый для запуска тестов:

![txt](screen\txt.png)


### 5. Выложенные файлы на репозиторий

Отправка файлов py и txt  осуществлялась благодаря командам `git`

```
git add .
git commit -m "upd"
git push origin main 
```

Снизу скриншот  подтверждения того, что коммит был 

![commit](screen\commit.png)

## Вывод по Задаче 2

Разработано простое Python-приложение с функциями обработки текста, написаны модульные тесты и подготовлен файл зависимостей. Все компоненты успешно загружены в репозиторий GitLab, что подтверждено скриншотом коммита. Проект имеет чёткую и простую структуру, готовую к интеграции в GitLab CI/CD.
