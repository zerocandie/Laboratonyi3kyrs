ТЕОРЕТИЧЕСКИЕ ОСНОВЫ ЛАБОРАТОРНОЙ РАБОТЫ

1. ER-моделирование и нормализация до 3NF

ER-модель (Entity–Relationship) — это концептуальное представление предметной области в виде сущностей, их атрибутов и связей между ними. ER-диаграмма используется на этапе проектирования базы данных для визуального отображения структуры данных и бизнес-логики системы.

Сущность соответствует объекту предметной области (например, аптека, препарат, продажа).

Атрибуты описывают свойства сущности.

Связи показывают, как сущности взаимодействуют между собой (один-к-одному, один-ко-многим, многие-ко-многим).

Нормализация — это процесс логического проектирования базы данных, направленный на устранение избыточности и предотвращение аномалий обновления данных.

В данной работе схема приводится к третьей нормальной форме (3NF), что означает:

таблица находится в 1NF (все значения атомарны);

таблица находится во 2NF (все неключевые атрибуты полностью зависят от первичного ключа);

отсутствуют транзитивные зависимости неключевых атрибутов.

Зачем это нужно:

Нормализация повышает целостность данных, упрощает сопровождение схемы и предотвращает логические ошибки при вставке, обновлении и удалении данных.

2. DDL-скрипты и ограничения целостности

DDL (Data Definition Language) — подмножество SQL, предназначенное для описания структуры базы данных. С помощью DDL создаются таблицы, индексы, ограничения и связи между объектами.

Основные элементы DDL:

PRIMARY KEY (PK) — уникально идентифицирует строку таблицы;

FOREIGN KEY (FK) — обеспечивает ссылочную целостность между таблицами;

UNIQUE — запрещает дублирование значений;

CHECK — задаёт логические ограничения на допустимые значения;

INDEX — ускоряет выполнение запросов поиска и соединения таблиц.

Зачем это нужно:

DDL-ограничения переносят бизнес-логику на уровень базы данных и предотвращают появление некорректных данных независимо от прикладного кода.

3. Заполнение тестовыми данными

Тестовые данные — это искусственно созданные записи, имитирующие реальные данные предметной области. Они необходимы для проверки корректности структуры БД, ограничений, триггеров, транзакций и аналитических запросов.

В лабораторной работе используется набор тестовых данных объёмом не менее 50–200 строк в сумме по всем таблицам, что позволяет:

проверить производительность запросов;

продемонстрировать работу транзакций и блокировок;

сформировать отчёты и агрегаты.

Зачем это нужно:

Без тестовых данных невозможно объективно проверить корректность и эффективность работы базы данных.

4. Транзакции и управление изменениями данных

Транзакция — это логически завершённая последовательность операций с базой данных, выполняемая как единое целое.

Транзакции обеспечивают свойства ACID:

Atomicity — все операции либо выполняются полностью, либо не выполняются вовсе;

Consistency — база данных переходит из одного согласованного состояния в другое;

Isolation — параллельные транзакции не мешают друг другу;

Durability — зафиксированные изменения сохраняются даже при сбоях.

Команды управления транзакциями:

BEGIN — начало транзакции;

COMMIT — фиксация изменений;

ROLLBACK — откат изменений.

Зачем это нужно:

Транзакции критичны для финансовых и складских операций, где недопустима частичная фиксация данных (например, списание товара без регистрации продажи).

5. Уровни изоляции транзакций

Уровень изоляции определяет, какие изменения одной транзакции видны другим параллельным транзакциям.

Стандарт SQL определяет уровни:

READ UNCOMMITTED — допускает чтение незафиксированных данных (dirty read);

READ COMMITTED — читает только зафиксированные данные;

REPEATABLE READ — гарантирует неизменность прочитанных строк;

SERIALIZABLE — максимальная изоляция, эквивалент последовательного выполнения транзакций.

Влияние уровней изоляции проявляется через аномалии:

Dirty read — чтение незакоммиченных данных;

Non-repeatable read — повторное чтение даёт разные значения;

Phantom read — появление новых строк при повторном запросе.

Зачем это нужно:

Понимание уровней изоляции позволяет находить баланс между согласованностью данных и производительностью системы.

6. Блокировки и управление параллельным доступом

Блокировки используются для защиты данных от конфликтов при одновременном доступе нескольких транзакций.

Виды блокировок:

Пессимистическая блокировка (SELECT … FOR UPDATE) — строка блокируется до завершения транзакции;

Оптимистическая блокировка — конфликт обнаруживается при обновлении (например, через поле версии);

Дедлок — взаимная блокировка транзакций, при которой СУБД принудительно завершает одну из них.

Зачем это нужно:

Блокировки обеспечивают корректность параллельной работы пользователей и предотвращают потерю данных.

7. Рефакторинг схемы и устранение аномалий

Рефакторинг схемы — это изменение структуры БД без изменения её функционального назначения с целью устранения выявленных аномалий.

В процессе рефакторинга:

устраняется дублирование данных;

таблицы разделяются по ответственности;

вводятся корректные связи и ключи.

Преимущества нормализованной схемы:

целостность данных;

отсутствие аномалий;

простота сопровождения.

Недостатки:

усложнение запросов (JOIN);

возможное снижение производительности отчётов.

Зачем это нужно:

Рефакторинг повышает надёжность и масштабируемость базы данных.

8. Денормализация и материализованные представления

Денормализация — это осознанное введение избыточности для повышения производительности чтения данных.

Один из способов денормализации — материализованные представления, которые:

хранят заранее вычисленные агрегаты;

обновляются вручную или по расписанию;

существенно ускоряют аналитические запросы.

Зачем это нужно:

Для отчётов и аналитики часто важна скорость чтения, а не минимизация избыточности.

9. Работа с JSON/JSONB

JSON и JSONB используются для хранения полуструктурированных данных внутри реляционной базы.

JSONB:

хранит данные в бинарном виде;

поддерживает индексацию (GIN);

позволяет выполнять поиск по вложенным полям.

Зачем это нужно:

JSONB обеспечивает гибкость схемы без потери возможностей SQL-запросов и индексации.

10. Работа с XML и XPath/XQuery

XML используется для хранения иерархических документов, таких как медицинские рецепты или отчёты.

СУБД предоставляет:

XPath/XQuery для извлечения данных из XML;

возможность индексации извлечённых значений (через вычисляемые столбцы).

Зачем это нужно:

XML удобен для хранения сложных документов в исходном виде и обеспечивает совместимость с внешними системами
